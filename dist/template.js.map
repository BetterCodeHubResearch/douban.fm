{"version":3,"sources":["../libs/template.js"],"names":[],"mappings":"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","file":"libs/template.js","sourcesContent":["var sys = require('sys');\nvar color = require('colorful');\nvar printf = require('sprintf').sprintf;\nvar exec = require('child_process').exec;\nvar notifier = new require('node-notifier')();\nvar utils = require('./utils');\nvar pkg = require('../package');\n\nexports.logo = logo;\nexports.song = song;\nexports.share = share;\nexports.title = title;\nexports.notify = notify;\nexports.pause = pause;\nexports.listing = listing;\nexports.loading = loading;\nexports.updateTab = updateTab;\n\n/**\n * [make logo string]\n * @param  {[type]} account [description]\n * @return {[type]}         [description]\n */\nfunction logo(account) {\n  return printf(\n    '%s %s %s',\n    color.yellow('Douban FM'),\n    color.grey('v' + pkg.version),\n    account ? color.grey('/ ' + account.user_name) : ''\n  );\n}\n\n/**\n * [notify]\n * @param  {[type]} song [description]\n * @return {[type]}      [description]\n */\nfunction notify(song) {\n  notifier.notify({\n    title: song.notifyTitle || 'Douban FM',\n    open: song.open || pkg.repository.url,\n    message: song.text || pkg.name + ' v' + pkg.version\n  });\n}\n\n/**\n * [Update terminal tab's title]\n * @param  {String} str\n * @bug: 只有一个 tab 的时候这个 func 会导致 tab 页面闪动\n */\nfunction updateTab(str) {\n  exec('printf \"\\\\e]1;' + str + '\\\\a\"',\n    function(error, stdout, stderr) {\n      sys.puts(stdout);\n    }\n  );\n}\n\n/**\n * [Update title's text]\n * @param  {[type]} str\n * @param  {[type]} c  \n * @return {[type]}    \n */\nfunction title(str, c) {\n  if (!str) \n    return false;\n\n  // this.updateTab(str);\n  return color[c || 'grey'](str);\n}\n\n/**\n * [Listing]\n * @return {[type]}\n */\nfunction listing() {\n  return this.title('加载列表中，请稍等...')\n}\n\n/**\n * [Loading]\n * @return {[type]}\n */\nfunction loading() {\n  return this.title('歌曲缓冲中，请稍等..')\n}\n\n/**\n * [Pause]\n * @return {[type]}\n */\nfunction pause() {\n  this.title('Douban FM');\n  return color.yellow('||');\n}\n\n/**\n * [song]\n * @param  {[type]} s          [description]\n * @param  {[type]} selectText [description]\n * @param  {[type]} silence    [description]\n * @return {[type]}            [description]\n */\nfunction song(s, selectText, silence) {\n  var label = '♫ ';\n  var song = s.title ? s : {};\n  if (!song.title) {\n    song.text = label + '未知曲目...';\n    if (!silence) \n      this.notify(song);\n\n    return color.grey(song.text);\n  }\n\n  song.text = label + song.title + ' - ' + song.artist;\n  song.open = utils.album(song.album);\n\n  if (!silence) \n    this.notify(song);\n\n  return printf(\n    '%s %s %s %s %s %s %s %s',\n    song.like == 1 ? color.red('♥') : color.grey('♥'),\n    color.green(song.title),\n    color.grey(song.kbps + 'kbps'),\n    color.grey('... ♪ ♫ ♫ ♪ ♫ ♫ ♪ ♪ ...'),\n    selectText || color.yellow(song.albumtitle),\n    selectText ? '' : color.grey('•'),\n    selectText ? '' : song.artist,\n    selectText ? '' : color.grey(song.public_time)\n  )\n}\n\n/**\n * [share]\n * @param  {[type]} song [description]\n * @return {[type]}      [description]\n */\nfunction share(song) {\n  var shareText = \n    'http://service.weibo.com/share/share.php?' +\n    '&type=button' +\n    '&appkey=3374718187' +\n    '&ralateUid=1644105187' +\n    '&url=' +\n    pkg.repository.url +\n    '&pic=' +\n    (song.picture ? song.picture.replace('mpic', 'lpic') : '') +\n    '%7C%7C' +\n    'http://ww1.sinaimg.cn/large/61ff0de3tw1ecij3dq80bj20m40ez75u.jpg' +\n    '&title=' +\n    encodeURIComponent([\n      '我正用豆瓣电台命令行版 v' + pkg.version + ' 收听 ',\n      song.title ? '「' + song.title + '」' : '本地电台频道',\n      song.kbps ? song.kbps + 'kbps' : '',\n      song.albumtitle ? song.albumtitle + ' • ' : '',\n      song.artist || '',\n      song.public_time || '',\n      song.album ? utils.album(song.album) : ''\n    ].join(' '));\n\n  // windows 下终端 & 需要转义\n  if (process.platform === 'win32') \n    shareText = shareText.replace(/&/g, '^&');\n\n  return shareText;\n}\n"]}